<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.min.inquiry">
 
<!--  문의글 임시보관함 리스트 전체보기-->  
<select id="Mimsi_All" resultType="IDto">
SELECT SEQ ,ID ,NICNAME ,TITLE ,REGDATE
 FROM C_INQUIRY WHERE IMSI = 'Y'
</select> 

<!--  문의글 임시보관함 상세보기-->

<select id="Mimsi_Detail" parameterType="java.lang.String" resultType="IDto">
SELECT A.SEQ,A.ID,A.NICNAME ,A.TITLE,A.CONTENT ,A.REALFILE ,A.REGDATE 
 FROM C_INQUIRY A LEFT JOIN "FILE" B
ON(A.REALFILE =B.REALFILE )
 WHERE A.SEQ=#{seq} AND A.IMSI='Y'
</select>

<!--문의글 임시 보관함 수정하기-->
<update id="Mimsi_modify" parameterType="IDto"  >
UPDATE C_INQUIRY SET TITLE=#{title},CONTENT=#{content},REALFILE=#{realfile} WHERE SEQ=#{seq} AND IMSI='Y'
</update>

<!--문의글 임시 보관함 삭제하기-->
<delete id="MiImsi_Delete" parameterType="java.lang.String" >
DELETE FROM C_INQUIRY WHERE SEQ=#{seq} AND IMSI='Y'
</delete>


<!--문의글 보관함 리스트 전체보기     -->
<select id="Mstore_All" resultType="IDto">
SELECT SEQ ,ID ,NICNAME ,TITLE ,REGDATE 
 FROM C_INQUIRY WHERE IMSI ='N'
</select>

<!--문의글 보관함 상세보기            -->
<select id="Mstore_Detail" parameterType="java.lang.String" resultType="IDto">

SELECT A.SEQ,A.ID,A.NICNAME ,A.TITLE,A.CONTENT ,A.REALFILE ,A.REGDATE 
 FROM C_INQUIRY A LEFT JOIN "FILE" B
ON(A.REALFILE =B.REALFILE )
 WHERE A.SEQ={seq} AND A.IMSI='Y'
</select>



<!--문의글 보관함 수정하기            -->
<update id="Mstore_modify" parameterType="IDto">
UPDATE C_INQUIRY SET TITLE=#{title},CONTENT=#{content},REALFILE=#{realfile} WHERE SEQ=#{seq} AND IMSI='N'
</update>


<!--문의글 보관함 삭제하기  -->
<delete id="Mstore_Delete" parameterType="java.lang.String">  
  DELETE FROM C_INQUIRY WHERE SEQ=#{seq} AND IMSI='N'
</delete>

<!--소비자 문의 게시판 (글 입력)(소비자)-->
<insert id="c_insertBoard" parameterType="IDto">
INSERT INTO C_INQUIRY
(SEQ, REALFILE, ID, NICNAME, REGDATE, TITLE, CONTENT)
VALUES(C_INQUIRY_SEQ.NEXTVAL,#{realfile},#{id},#{nicname},SYSDATE,#{title},#{content})
WHERE AUTH='C'
</insert>
  
<!-- 소비자문의게시판 (글 전체 조회)(소비자)-->
<select id="C_allSelectBoard" resultType="IDto">
SELECT SEQ,ID,NICNAME,REGDATE,TITLE,CONTENT,AUTH,REALFILE,IMSI
FROM C_INQUIRY
</select>

<!-- 소비자문의게시판 (글 상세 조회)(소비자) -->
 <select id="C_SelectBoardDetail" resultType="IDto">
 SELECT A.SEQ,A.ID,TITLE,CONTENT ,A.REALFILE ,REGDATE
  FROM C_INQUIRY A LEFT JOIN "FILE" B
   ON (A.REALFILE =B.REALFILE )
   WHERE AUTH='C'
 </select>
 
  
<!-- 소비자문의게시판 (글 전체 조회)(업체)-->
<select id="S_allSelectBoard" resultType="IDto">
SELECT SEQ,NICNAME,TITLE,REGDATE FROM C_INQUIRY WHERE AUTH='S'
</select>

<!-- 소비자문의게시판 (글 상세 조회)(업체) -->
 <select id="S_SelectBoardDetail" resultType="IDto">
SELECT A.SEQ,A.ID,TITLE,CONTENT ,A.REALFILE ,REGDATE
  FROM C_INQUIRY A LEFT JOIN "FILE" B
   ON (A.REALFILE =B.REALFILE ) WHERE AUTH='S'
 </select>
 
 <!-- 임시문의글을 진짜 문의글로 바꾸기 -->
 <update id="">
 
 </update>

 
 <!-- 견적서 작성 -->
 <insert id="s_esimake" parameterType="EDto">
INSERT INTO ESTIMATE_MAKE
(SEQ, ID, REGDATE, TITLE, CONTENT, REALFILE)
VALUES(ESTIMATE_MAKE_SEQ.NEXTVAL,#{id}, SYSDATE, #{title}, #{content}, #{realfile}) WHERE AUTH='S'
 </insert>
  
</mapper>
